<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sesli Stok AsistanÄ±</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#0f172a;
    color:white;
    text-align:center;
    padding:20px;
}
button{
    font-size:22px;
    padding:20px;
    border-radius:15px;
    border:none;
    background:#22c55e;
    color:white;
    width:90%;
    max-width:400px;
    margin-top:30px;
}
#response{
    margin-top:40px;
    font-size:20px;
    background:#1e293b;
    padding:20px;
    border-radius:15px;
}
</style>
</head>

<body>

<h2>ğŸ¤ Sesli Stok AsistanÄ±</h2>
<p>Butona bas ve konuÅŸ</p>

<button onclick="startListening()">KonuÅŸmaya BaÅŸla</button>

<div id="response">Cevap burada gÃ¶rÃ¼necek...</div>

<script>

// =========================
// GÃ–MÃœLÃœ STOK TABLOSU (KG)
// =========================
const stockData = {
  "BIM": {
    "KARABIBER": 30000,
    "KIMYON": 20000,
    "PUL BIBER": 80000,
    "KEKIK": 15000
  },
  "KNORR": {
    "PUL BIBER": 5000,
    "KARABIBER": 5000,
    "KEKIK": 2500,
    "ZERDECAL": 3000
  },
  "METRO": {
    "KEKIK": 2500,
    "PUL BIBER": 20000,
    "KARABIBER": 5000
  }
};

// =========================
// SES TANIMA
// =========================
function startListening(){
    const recognition = new(window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = "tr-TR";
    recognition.start();

    recognition.onresult = function(event){
        let text = event.results[0][0].transcript.toUpperCase();
        processCommand(text);
    }
}

// =========================
// YANIT SESLENDÄ°RME
// =========================
function speak(text){
    const speech = new SpeechSynthesisUtterance(text);
    speech.lang = "tr-TR";
    speechSynthesis.speak(speech);
}

// =========================
// KOMUT Ä°ÅLEME
// =========================
function processCommand(text){

    document.getElementById("response").innerText = "AlgÄ±lanan: " + text;

    let firm = null;
    let product = null;

    // Firma tespiti
    if(text.includes("BIM")) firm="BIM";
    if(text.includes("KNORR")) firm="KNORR";
    if(text.includes("METRO")) firm="METRO";

    if(!firm){
        speak("Firma bulunamadÄ±");
        return;
    }

    // ÃœrÃ¼n eÅŸleÅŸtirme
    Object.keys(stockData[firm]).forEach(p=>{
        if(text.includes(p)){
            product = p;
        }
    });

    if(!product){
        speak("ÃœrÃ¼n bulunamadÄ±");
        return;
    }

    let minimum = stockData[firm][product];

    // Minimum kapasite sorusu
    if(text.includes("MINIMUM")){
        let ton = minimum / 1000;
        let answer = firm + " " + product + " minimum kapasitesi " + ton + " ton.";
        document.getElementById("response").innerText = answer;
        speak(answer);
        return;
    }

    // Depomda X ton var sorgusu
    let tonMatch = text.match(/(\d+)\s*TON/);

    if(tonMatch){
        let mevcutTon = parseInt(tonMatch[1]);
        let mevcutKg = mevcutTon * 1000;

        if(mevcutKg >= minimum){
            let answer = "Stok yeterli.";
            document.getElementById("response").innerText = answer;
            speak(answer);
        }else{
            let siparisKg = minimum - mevcutKg;
            let siparisTon = siparisKg / 1000;
            let answer = siparisTon + " ton sipariÅŸ vermelisiniz.";
            document.getElementById("response").innerText = answer;
            speak(answer);
        }
        return;
    }

    speak("Komut anlaÅŸÄ±lamadÄ±.");
}

</script>

</body>
</html>