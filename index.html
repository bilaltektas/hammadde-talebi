<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Stok Sesli Asistan</title><style>body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI;background:#0f172a;color:white;text-align:center}h1{margin-top:20px}button{width:90%;max-width:400px;padding:18px;margin:10px;border-radius:12px;border:none;font-size:18px;background:#2563eb;color:white}#log{width:90%;max-width:600px;margin:20px auto;background:#1e293b;padding:15px;border-radius:12px;height:260px;overflow:auto;text-align:left;font-size:14px}</style></head><body><h1>üéôÔ∏è Stok Asistan</h1><button onclick="initAudio()">Sistemi Ba≈ülat</button><button onclick="startListening()">Konu≈ü</button><div id="log"></div><script>
let voicesLoaded=false
let memory={lastFirma:null,lastUrun:null}

const data=[{firma:"BIM",urun:"KARABIBER",min:30000},{firma:"KNORR",urun:"PUL BIBER",min:5000}]

function normalize(t){return t.toUpperCase().replace(/ƒ∞/g,"I").replace(/≈û/g,"S").replace(/ƒû/g,"G").replace(/√ú/g,"U").replace(/√ñ/g,"O").replace(/√á/g,"C")}

function initAudio(){
speechSynthesis.getVoices()
voicesLoaded=true
speak("Ses sistemi hazƒ±r.")
}

function speak(text){
if(!voicesLoaded){console.log("Voice not ready");return}
speechSynthesis.cancel()
let u=new SpeechSynthesisUtterance(text)
u.lang="tr-TR"
u.volume=1
u.rate=1
u.pitch=1
speechSynthesis.speak(u)
}

function log(t){document.getElementById("log").innerHTML+="<div>"+t+"</div>";document.getElementById("log").scrollTop=99999}

function findMatch(text){
let n=normalize(text)
let f=data.find(d=>n.includes(d.firma))
let u=data.find(d=>n.includes(d.urun))
if(f)memory.lastFirma=f.firma
if(u)memory.lastUrun=u.urun
if(!memory.lastFirma||!memory.lastUrun)return null
return data.find(d=>d.firma===memory.lastFirma&&d.urun===memory.lastUrun)
}

function extractNumber(text){
let n=text.match(/(\d+)/)
if(!n)return null
let value=parseInt(n[0])
if(text.includes("ton"))value*=1000
return value
}

function startListening(){
const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition
if(!SpeechRecognition){alert("Tarayƒ±cƒ± desteklemiyor");return}
let recognition=new SpeechRecognition()
recognition.lang="tr-TR"
recognition.start()
recognition.onresult=function(e){
let text=e.results[0][0].transcript
log("üë§ "+text)
process(text)
}
recognition.onerror=function(){speak("Seni anlayamadƒ±m")}
}

function process(text){
let match=findMatch(text)
if(!match){speak("√úr√ºn√º anlayamadƒ±m");return}
let stock=extractNumber(text)
if(stock==null){speak("Stok miktarƒ±nƒ± s√∂ylemedin");return}
let min=match.min
let response=""
if(stock<min){
let need=min-stock
response="Kritik stok. "+(need/1000).toFixed(2)+" ton sipari≈ü vermelisin."
}else{
response="Stok yeterli."
}
log("ü§ñ "+response)
setTimeout(()=>{speak(response)},300)
}
</script></body></html>
