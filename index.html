<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Ultra Stok Asistan Final</title><style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI;background:linear-gradient(135deg,#0f172a,#1e293b);color:white;text-align:center}
h1{margin-top:20px;font-size:22px}
.container{width:95%;max-width:700px;margin:auto}
.card{background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border-radius:16px;padding:20px;margin-top:20px;box-shadow:0 0 25px rgba(0,0,0,0.4)}
button{width:100%;padding:16px;margin-top:10px;border-radius:12px;border:none;font-size:16px;background:#2563eb;color:white}
#log{height:220px;overflow:auto;text-align:left;font-size:14px}
#result{font-size:34px;font-weight:bold;margin-top:20px}
.blink{animation:blink 1s infinite}
@keyframes blink{0%{opacity:1}50%{opacity:0.2}100%{opacity:1}}
.green{color:#22c55e}
.orange{color:#f59e0b}
.red{color:#ef4444}
</style></head><body><h1>üéôÔ∏è Ultra Stok Asistan</h1><div class="container"><div class="card"><button onclick="initSystem()">Sistemi Ba≈ülat</button><button onclick="startListening()">Konu≈ü</button><button onclick="resetFlow()">Ba≈üka Soru Sor</button><div id="log"></div></div><div class="card"><div id="result"></div></div></div><script>
let state="idle"
let currentFirma=null
let currentUrun=null
let voicesReady=false

const firmaAlias={
"BIM":"BIM","BIM MARKET":"BIM","BIMMM":"BIM","BIM":"BIM","BIM":"BIM","BIM":"BIM","BIM":"BIM",
"BIM":"BIM","BIM":"BIM","BIM":"BIM",
"BIM":"BIM","BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"BIM":"BIM",
"FILE":"FILE","Fƒ∞LE":"FILE",
"METRO":"METRO",
"KINOR":"KNORR","KINORR":"KNORR","Kƒ∞NOR":"KNORR","KNORR":"KNORR"
}

const data=[{firma:"BIM",urun:"KARABIBER",min:30000},{firma:"BIM",urun:"PUL BIBER",min:80000},{firma:"FILE",urun:"KARABIBER",min:3000},{firma:"METRO",urun:"KIMYON",min:3000},{firma:"KNORR",urun:"PUL BIBER",min:5000}]

const numberWords={"BIR":1,"IKI":2,"UC":3,"DORT":4,"BES":5,"ALTI":6,"YEDI":7,"SEKIZ":8,"DOKUZ":9,"ON":10}

function normalize(t){return t.toUpperCase().replace(/ƒ∞/g,"I").replace(/≈û/g,"S").replace(/ƒû/g,"G").replace(/√ú/g,"U").replace(/√ñ/g,"O").replace(/√á/g,"C")}
function speak(t){if(!voicesReady)return;speechSynthesis.cancel();let u=new SpeechSynthesisUtterance(t);u.lang="tr-TR";speechSynthesis.speak(u)}
function log(t){document.getElementById("log").innerHTML+="<div>"+t+"</div>"}

function initSystem(){speechSynthesis.getVoices();voicesReady=true;state="firma";speak("Merhaba. Hangi firma?")}

function resetFlow(){state="firma";currentFirma=null;currentUrun=null;document.getElementById("result").innerHTML="";speak("Hangi firma?")}

function startListening(){const SR=window.SpeechRecognition||window.webkitSpeechRecognition;if(!SR){alert("Destek yok");return}let r=new SR();r.lang="tr-TR";r.start();r.onresult=e=>{let text=e.results[0][0].transcript;log("üë§ "+text);process(text)}}

function process(text){
let n=normalize(text)

if(state==="firma"){
for(let key in firmaAlias){if(n.includes(normalize(key))){currentFirma=firmaAlias[key];state="urun";speak("Hangi hammadde?");return}}
speak("Firmayƒ± anlayamadƒ±m");return}

if(state==="urun"){
let u=data.find(d=>d.firma===currentFirma&&n.includes(d.urun))
if(!u){speak("Hammaddeyi anlayamadƒ±m");return}
currentUrun=u.urun;state="stok";speak("Depoda ka√ß kilogram var?");return}

if(state==="stok"){
let kg=parseQuantity(n)
if(kg==null){speak("Miktarƒ± anlayamadƒ±m");return}
let rec=data.find(d=>d.firma===currentFirma&&d.urun===currentUrun)
let min=rec.min
let result=document.getElementById("result")
if(kg<min){
let need=min-kg
let ton=(need/1000).toFixed(2)
result.className="blink red"
result.innerHTML=ton+" TON Sƒ∞PARƒ∞≈û"
}else if(kg<min*1.2){
result.className="blink orange"
result.innerHTML="Rƒ∞SKLƒ∞ SEVƒ∞YE"
}else{
result.className="green"
result.innerHTML="STOK YETERLƒ∞"
}
state="idle"
}
}

function parseQuantity(text){
if(text.includes("BUCUK")){
for(let w in numberWords){if(text.includes(w)){return (numberWords[w]+0.5)*1000}}
}
let num=text.match(/(\d+(\.\d+)?)/)
if(num){
let val=parseFloat(num[0])
if(text.includes("TON"))return val*1000
return val
}
for(let w in numberWords){
if(text.includes(w)){
let val=numberWords[w]
if(text.includes("TON"))return val*1000
return val
}}
return null
}
</script></body></html>
